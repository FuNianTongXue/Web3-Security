[
  {
    "id": "slither-arbitrary-send-erc20",
    "title": "ERC20 转账接收方可控",
    "severity": "P1",
    "category": "Access Control",
    "impact": "中危",
    "confidence": "70%",
    "slither_ref": "arbitrary-send-erc20",
    "description": "transfer/transferFrom 接收方若直接取自外部参数存在劫持风险。",
    "remediation": "关键转账目标使用白名单或固定受益人。",
    "regex": "transferFrom\\s*\\(|transfer\\s*\\(",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-assembly",
    "title": "内联 assembly 高风险区",
    "severity": "P2",
    "category": "Maintainability",
    "impact": "低危",
    "confidence": "90%",
    "slither_ref": "assembly",
    "description": "assembly 容易绕过编译器安全检查。",
    "remediation": "缩小 assembly 范围并添加单元测试/审计注释。",
    "regex": "assembly\\s*\\{",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-calls-loop",
    "title": "循环中外部调用",
    "severity": "P1",
    "category": "DoS",
    "impact": "中危",
    "confidence": "70%",
    "slither_ref": "calls-loop",
    "description": "for/while 中执行外部调用可能导致 gas DoS。",
    "remediation": "批处理拆分、pull 模式、限制循环规模。",
    "regex": "for\\s*\\(|while\\s*\\(|\\.call\\s*\\(|transfer\\s*\\(",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-controlled-delegatecall",
    "title": "可控 delegatecall",
    "severity": "P0",
    "category": "Code Execution",
    "impact": "高危",
    "confidence": "70%",
    "slither_ref": "controlled-delegatecall",
    "description": "delegatecall 目标若可控将导致存储污染或接管。",
    "remediation": "目标地址使用固定实现/白名单，并限制升级入口。",
    "regex": "delegatecall\\s*\\(",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-divide-before-multiply",
    "title": "先除后乘精度损失",
    "severity": "P1",
    "category": "Math",
    "impact": "中危",
    "confidence": "70%",
    "slither_ref": "divide-before-multiply",
    "description": "先除后乘在整数算术下会引发精度损失。",
    "remediation": "在溢出安全前提下优先先乘后除并统一舍入策略。",
    "regex": "/\\s*\\w+\\s*\\*|\\w+\\s*/\\s*\\w+\\s*\\*",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-missing-zero-check",
    "title": "关键地址缺少零地址校验",
    "severity": "P1",
    "category": "Validation",
    "impact": "中危",
    "confidence": "70%",
    "slither_ref": "missing-zero-check",
    "description": "设置管理员/实现/资金接收地址时缺少 address(0) 校验。",
    "remediation": "关键地址赋值/更新时强制 require(addr != address(0))。",
    "regex": "address\\s+\\w+|set\\w*\\s*\\(\\s*address",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-oracle-manipulation",
    "title": "可操纵现货价作为预言机",
    "severity": "P0",
    "category": "Oracle",
    "impact": "高危",
    "confidence": "70%",
    "slither_ref": "price-manipulation (custom)",
    "description": "检测直接以 AMM spot/getReserves 用于估值或借贷。",
    "remediation": "改用独立预言机 + TWAP + 偏离熔断。",
    "regex": "getReserves\\s*\\(|spot\\s*price|consult\\s*\\(",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-reentrancy-eth",
    "title": "可能存在 ETH 重入",
    "severity": "P0",
    "category": "Reentrancy",
    "impact": "高危",
    "confidence": "70%",
    "slither_ref": "reentrancy-eth",
    "description": "检测 call/value/send 等外部转账调用缺少重入防护。",
    "remediation": "使用 CEI 顺序、ReentrancyGuard，并在外部调用前更新状态。",
    "regex": "\\.call\\s*\\{|\\.call\\s*\\(|\\.send\\s*\\(|\\.transfer\\s*\\(",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-reentrancy-no-eth",
    "title": "可能存在无 ETH 重入",
    "severity": "P0",
    "category": "Reentrancy",
    "impact": "高危",
    "confidence": "70%",
    "slither_ref": "reentrancy-no-eth",
    "description": "检测外部合约交互（swap/mint/burn/callback）缺少互斥保护。",
    "remediation": "对关键状态路径增加 nonReentrant 并拆分外部调用逻辑。",
    "regex": "swap\\s*\\(|mint\\s*\\(|burn\\s*\\(|callback|onERC|external\\s+call",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-shadowing-state",
    "title": "变量遮蔽风险",
    "severity": "P2",
    "category": "Code Quality",
    "impact": "低危",
    "confidence": "40%",
    "slither_ref": "shadowing-state",
    "description": "局部变量/参数与状态变量同名会降低可读性并引入错误。",
    "remediation": "统一命名规范，避免与状态变量重名。",
    "regex": "\\b(uint|int|address|bytes|string|bool)\\s+\\w+\\s*=",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-suicidal",
    "title": "危险销毁函数",
    "severity": "P0",
    "category": "Access Control",
    "impact": "高危",
    "confidence": "70%",
    "slither_ref": "suicidal",
    "description": "检测 selfdestruct/suicide，若权限不足会导致合约不可用。",
    "remediation": "严格限制销毁权限，优先停用而非销毁。",
    "regex": "selfdestruct\\s*\\(|suicide\\s*\\(",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-timestamp",
    "title": "时间戳依赖",
    "severity": "P1",
    "category": "Logic",
    "impact": "中危",
    "confidence": "90%",
    "slither_ref": "timestamp",
    "description": "关键逻辑直接依赖 block.timestamp 可能受矿工轻度操纵。",
    "remediation": "使用宽容时间窗口并避免将 timestamp 作为唯一安全条件。",
    "regex": "block\\.timestamp",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-tx-origin",
    "title": "使用 tx.origin 做认证",
    "severity": "P0",
    "category": "Access Control",
    "impact": "高危",
    "confidence": "90%",
    "slither_ref": "tx-origin",
    "description": "tx.origin 认证容易被钓鱼合约绕过。",
    "remediation": "认证仅使用 msg.sender + 角色控制。",
    "regex": "tx\\.origin",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-unchecked-transfer",
    "title": "ERC20 返回值未检查",
    "severity": "P1",
    "category": "Standards",
    "impact": "中危",
    "confidence": "70%",
    "slither_ref": "unchecked-transfer",
    "description": "部分 ERC20 不 revert 仅返回 false，未检查会导致静默失败。",
    "remediation": "使用 SafeERC20 或显式检查返回值。",
    "regex": "\\.transfer\\s*\\(|\\.transferFrom\\s*\\(",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-unprotected-upgrade",
    "title": "升级入口可能未保护",
    "severity": "P0",
    "category": "Upgradeability",
    "impact": "高危",
    "confidence": "70%",
    "slither_ref": "unprotected-upgrade",
    "description": "升级函数缺少 onlyOwner/role 校验会被恶意升级。",
    "remediation": "升级函数强制访问控制与 timelock，多签治理。",
    "regex": "upgradeTo\\s*\\(|upgradeToAndCall\\s*\\(|setImplementation\\s*\\(",
    "enabled": true,
    "builtin": true
  },
  {
    "id": "slither-weak-prng",
    "title": "弱随机源",
    "severity": "P1",
    "category": "Cryptography",
    "impact": "中危",
    "confidence": "90%",
    "slither_ref": "weak-prng",
    "description": "基于 block.timestamp/blockhash 等链上变量生成随机数可被操纵。",
    "remediation": "使用 VRF/commit-reveal/可信随机服务。",
    "regex": "block\\.timestamp|blockhash\\s*\\(|block\\.number|keccak256\\s*\\(",
    "enabled": true,
    "builtin": true
  }
]